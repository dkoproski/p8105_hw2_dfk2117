p8105_hw2_dfk2117
================
2023-09-27

## Required libraries

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

## Problem 1

### Wotrking with the politicians data

``` r
df_politicians =
  read_csv("data/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate(mon, into = c("year", "month", "day")) |> 
  mutate(month = month.name[as.numeric(month)]) |> 
  mutate(
    president = case_when(
      prez_gop %in% c(1,2) ~ "gop",
      prez_dem == 1 ~ "dem",
    )
  ) |>  
  select(-prez_gop, -prez_dem, -day) |> 
  arrange(year, month)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Working with the S&P data

``` r
df_snp = 
  read_csv("data/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("year", "month", "day")) |> 
  mutate(month = month.name[as.numeric(month)]) |> 
  select(-day) |> 
  arrange(year, month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Unemployment data

``` r
df_unemployment =
  read.csv("data/unemployment.csv") |> 
  janitor::clean_names()
```

### merging datasets

# Problem 2

``` r
df_mr_trash =
  readxl::read_excel("data/202207 Trash Wheel Collection Data.xlsx", sheet = 1) |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  select(-x15, -x16) |> 
  mutate(homes_powered = ((weight_tons * 500)/30)) |> 
  mutate(trash_wheel = "Mr_Trash") |> 
  mutate(year = as.numeric(year))
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
df_pr_trash =
  readxl::read_excel("data/202207 Trash Wheel Collection Data.xlsx", sheet = 2) |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = ((weight_tons * 500)/30)) |> 
  mutate(trash_wheel = "Prof_Trash") |> 
  mutate(year = as.numeric(year))

df_gw_trash =
  readxl::read_excel("data/202207 Trash Wheel Collection Data.xlsx", sheet = 4) |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = ((weight_tons * 500)/30)) |> 
  mutate(trash_wheel = "Gwynnda") |> 
  mutate(year = as.numeric(year))

df_all_wheels = 
  bind_rows(df_gw_trash, df_mr_trash, df_pr_trash) |> 
  relocate(homes_powered) |> 
  relocate(dumpster) |> 
  relocate(trash_wheel)
```

Each of these three datasets contained a month, year and date variable
(yyyy/mm/dd). They also contained a dumpster number variable and another
two variables representing the amount of trash (in tons) and the volume
of the trash (cubic yards) respectively. Each trash wheel also had
counts of how many of a certain type of trash was picked up on that
date. For Mr. Trash Wheel, this included Plastic Bottles, Polystyrene,
Cigarette Butts, Glass Bottles Grocery Bags, Chip Bags and Sports Balls.
Professor Trash Wheel’s data included all of these same counts except
for the Sports Balls count. Gwynda only included 4 of the 7 counts:
Plastic Bottles, Polystyrene, Cigarette Butts and Plastic Bags. Finally,
all 3 datasets contained a homes_powered variable which was incomplete.

The resulting dataset contains all of the variables that the previous
three contained, but now has a variable that labels which trash wheel
the data comes from as well as the edited `homes_powered` variable that
I made. I considered removing the counts of trash items that did not
overlap in all 3 datasets, but I decided to leave them in for
completeness.

## Problem 3

``` r
df_baseline_mci =
  read_csv("data/data_mci/MCI_baseline_trimmed.csv") |>
  janitor::clean_names() |> 
  mutate(apoe4 =
    case_when(
      apoe4 == 1 ~ "carrier",
      apoe4 == 0 ~ "non-carrier")) |> 
  mutate(sex =
    case_when(
      sex == 1 ~ "male",
      sex == 0 ~ "female")) |> 
  filter(age_at_onset != ".") |> 
  mutate(age_at_onset = as.numeric(as.character(age_at_onset)))
```

    ## Rows: 483 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Age at onset
    ## dbl (5): ID, Current Age, Sex, Education, apoe4
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

During the import process, the first row needed to be removed as the
names of each individual variable were being treated as an individual. I
made a copy and removed the extraneous row before importing.

Based on the dataset, 483 were recruited and of those, 97 developed mci.
The mean baseline age is 70.3 years and the code that gives it is:

``` r
df_baseline_mci |> 
  summarise(mean(age_at_onset))
```

    ## # A tibble: 1 × 1
    ##   `mean(age_at_onset)`
    ##                  <dbl>
    ## 1                 70.3

0.652 or 65.2% of females in the baseline study are carriers of apoe4.
The code for this result is below:

``` r
df_baseline_mci |> 
  summarise(
    total_females = sum(sex == "female"),
    female_carriers = sum(sex == "female" & apoe4 == "carrier")) |> 
  mutate(f_carrier_ratio = female_carriers / total_females) |> 
  pull(f_carrier_ratio)
```

    ## [1] 0.6521739

Similarly, import, clean, and tidy the dataset of longitudinally
observed biomarker values; comment on the steps on the import process
and the features of the dataset.

Check whether some participants appear in only the baseline or amyloid
datasets, and comment on your findings. Combine the demographic and
biomarker datasets so that only participants who appear in both datasets
are retained, and briefly describe the resulting dataset; export the
result as a CSV to your data directory.
